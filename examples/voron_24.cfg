#####################################################################
##  LUMEN 1.4.4 Configuration - Voron 2.4 Example
##
##  Typical Setup:
##    - Voron 2.4 (any size)
##    - Raspberry Pi (any model)
##    - Chamber LED strip (GPIO-connected)
##    - Stealthburner toolhead LEDs (MCU-connected)
##
##  This config shows a common V2.4 setup with:
##    - Chamber strip on GPIO for smooth 60fps effects
##    - Toolhead logo + nozzle LEDs via Klipper
##    - Separate effects for different zones
##
#####################################################################

[lumen_settings]
max_brightness: 0.5        # Adjust for your preference
temp_floor: 25
bored_timeout: 300         # 5 minutes
sleep_timeout: 600         # 10 minutes
update_rate: 0.1
update_rate_printing: 5.0
gpio_fps: 60

[lumen_effect pulse]
speed: 1.0
min_brightness: 0.2
max_brightness: 0.8

[lumen_effect heartbeat]
speed: 1.2
min_brightness: 0.1
max_brightness: 1.0

[lumen_effect disco]
speed: 3.0
min_sparkle: 1
max_sparkle: 6

[lumen_effect thermal]
temp_source: chamber       # V2.4 has chamber temp sensor
start_color: ice
end_color: lava
gradient_curve: 2.0

[lumen_effect progress]
start_color: steel
end_color: matrix
gradient_curve: 1.5

[lumen_effect rainbow]
speed: 0.5                 # Cycles per second
rainbow_spread: 1.0        # How much rainbow spreads across strip
max_brightness: 0.9

[lumen_effect fire]
speed: 5.0                 # Flicker updates per second
min_brightness: 0.4
max_brightness: 1.0
fire_cooling: 0.4          # Cooling rate (higher = more chaotic)

[lumen_effect comet]
speed: 10.0                # Movement speed (LEDs per second)
max_brightness: 1.0
comet_tail_length: 10      # Length of trailing tail
comet_fade_rate: 0.5       # How quickly tail fades

[lumen_effect chase]
speed: 15.0                # Movement speed (LEDs per second)
chase_size: 5              # LEDs per segment
chase_color_1: red         # First segment color (predator)
chase_color_2: blue        # Second segment color (prey)
chase_offset_base: 0.5     # Base distance between segments (single-group only)
chase_offset_variation: 0.1 # How much offset varies (single-group only)
chase_proximity_threshold: 0.15  # 15% of ring = "getting close" (multi-group)
chase_accel_factor: 1.5    # Speed boost when hunting/fleeing (multi-group)
chase_role_swap_interval: 7.0    # Avg seconds between role swaps (multi-group)
chase_collision_pause: 0.3 # Seconds to pause after collision (multi-group)
max_brightness: .6

[lumen_effect kitt]
speed: .8                  # Bounce speed (sweeps per second)
base_color: red            # Scanner color (classic red!)
kitt_eye_size: 2           # LEDs in bright center eye
kitt_tail_length: 4        # Fading LEDs on each side
kitt_tracking_axis: none   # "none" | "x" | "y" (for bed mesh tracking)
max_brightness: .6

#####################################################################
##  Chamber LED Strip (GPIO)
#####################################################################

[lumen_group chamber_leds]
driver: proxy
gpio_pin: 18               # GPIO 18 recommended (no conflicts)
proxy_host: 127.0.0.1
proxy_port: 3769
index_start: 1
index_end: 60              # Adjust for your strip length
color_order: GRB
direction: standard
on_idle: solid dimwhite    # Soft white when ready
on_heating: thermal chamber ice lava 2.0  # Shows chamber heating
on_printing: progress steel matrix 1.5
on_cooldown: pulse ice
on_error: heartbeat red
on_bored: disco
on_sleep: off

#####################################################################
##  Stealthburner Toolhead LEDs (Klipper)
##
##  Requires in printer.cfg:
##    [neopixel sb_leds]
##    pin: EBBCan:PD3      # Or your MCU pin
##    chain_count: 3       # Logo (1) + Nozzle (2)
##    color_order: GRB
##
#####################################################################

# Logo LED (single LED, center of toolhead)
[lumen_group toolhead_logo]
driver: klipper
neopixel: sb_leds          # Must match your printer.cfg
index_start: 1
index_end: 1
direction: standard
on_idle: pulse cobalt      # Breathing blue = ready
on_heating: solid orange   # Orange = heating
on_printing: solid white   # White = printing
on_cooldown: pulse ice     # Cyan = cooling
on_error: heartbeat red    # Red pulse = error
on_bored: disco
on_sleep: off

# Nozzle LEDs (work lights, 2 LEDs)
[lumen_group toolhead_nozzle]
driver: klipper
neopixel: sb_leds
index_start: 2
index_end: 3
direction: standard
on_idle: off               # Off when not needed
on_heating: solid orange   # Orange during heatup
on_printing: solid white   # Full brightness work lights
on_cooldown: off
on_error: heartbeat red
on_bored: off
on_sleep: off

#####################################################################
##  NOTES FOR VORON 2.4
#####################################################################

## Chamber Temperature:
##   If you have a chamber temp sensor in printer.cfg:
##     [temperature_sensor chamber]
##     sensor_type: Generic 3950
##     sensor_pin: your_pin
##
##   Then thermal effect can use it:
##     on_heating: thermal chamber ice lava 2.0

## Typical V2.4 LED Wiring:
##   Chamber Strip:
##     - Pi GPIO 18 → LED strip DIN
##     - 5V PSU → LED strip power
##     - Common ground between Pi and PSU
##
##   Toolhead (via CAN):
##     - EBB42/36 board PD3 → Stealthburner LEDs
##     - 24V buck converter → 5V for LEDs

## Brightness for ABS Printing:
##   V2.4 is often enclosed, LEDs can be bright:
##     - Start with max_brightness: 0.3-0.5
##     - Adjust based on preference

## GPIO Pin Recommendation:
##   - Use GPIO 18 (PWM0) - most reliable
##   - Avoid GPIO 19 if using Pi audio

#####################################################################
